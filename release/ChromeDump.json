{"urlRegex": "^http://((meta\\.|careers\\.|math\\.|russ\\.|admin\\.|user\\.)?hashcode|bitcode|rootcode|(games|turism|foto|hm|phys|english)?\\.sezn)\\.ru", "name": "HashCode Addons", "filters": [], "urlExcludeRegex": "", "html": "<script>\n\nvar __addons=['__autocompleteWithSelection'];\nvar __addonsStarted= false;\n\nfunction __toogleEnabled(name, value){\n    value= value? \"yes\":\"no\";\n    localStorage[\"__Enable__\"+name]= value;\n};\n\nfunction __addonLoader() {\n    __addonsStarted= true;\n    var div1= document.createElement('div');\n    div1.style.display=\"none\";\n    div1.id= \"__div_options\";\n    var htmlDiv=\"<TABLE>\";\n    for (var i in __addons) {\n        htmlDiv+=\"<TR><TD><INPUT type='checkbox' onclick='__toogleEnabled(\\\"\"+__addons[i]+\"\\\", this.checked);' \";\n        if (localStorage[\"__Enable__\"+__addons[i]]==\"yes\") htmlDiv+=\"checked \";\n        htmlDiv+=\"></TD><TD>\"+__addons[i].replace(\"__\", \"\")+\"</TD></TR>\";\n    };\n    htmlDiv+=\"</TABLE>\";\n    console.log(htmlDiv);\n    div1.innerHTML=htmlDiv;\n    var img=document.createElement('img');\n    img.src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAIAAAADnC86AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAACjSURBVFhH7dNBCsMwEEPRnif36c1yVe+rYBGKVpJNbALzURfNQB8E+mmjHd8T45e8QbirM/YI/K/28ZBUsJOoGA9JBTuJivGQVLCTqBgPSQU7iYrxkPQeWMh7PNsRll95dF28YDks2AXLo2XbB2971fgstru4++8UJSTGQ1LBTqJiPCQV7CQqxkNSwU6iYjwkFewkKsZD0qtgNKmiQRjNqK21H9+y+LNChwLDAAAAAElFTkSuQmCC\";\n    img.style.width=img.style.height=\"16px\";\n    img.id= \"__imageIcon\";\n    img.onclick= function(e) {\n        if (div1.style.display==\"none\") {\n            div1.style.display=\"block\";\n        } else {\n            div1.style.display=\"none\";\n        };\n    };\n    $(img).insertBefore($(\"#searchBar div a\")[0]);\n    $(div1).insertBefore(img);\n    for (var i in __addons) {\n        if (localStorage[\"__Enable__\"+__addons[i]]==\"yes\") {\n            window[__addons[i]]();\n        }\n    }\n};\n\ndocument.addEventListener( \"DOMContentLoaded\", __addonLoader, false );\nvar __check__Started= function(){\n    if (!__addonsStarted) __addonLoader();\n};\nwindow.setTimeout(__check__Started, 300);\n\n\nfunction __autocompleteWithSelection() {\n    var arrayUnique = function(a) {\n        return a.reduce(function(p, c) {\n            if (p.indexOf(c) < 0) p.push(c);\n            return p;\n        }, []);\n    };\n    var completeSelection= function( target, text, matchText) {\n        target.value=target.value.substring(0, target.adduser+1)+text+target.value.substring(target.selectionEnd);\n        target.selectionStart= target.adduser+matchText.length+1;\n        target.selectionEnd  = target.adduser+text.length+1;\n        // console.log([value, target.adduser, target.selectionStart]);\n    };\n    var regexUsers = new RegExp(\"<a\\\\s[^>]*href\\\\s*=\\\\s*\\\"\\/users\\/\\\\d(?![^>]*\\/(?:reputation|subscriptions)\\/)[^>]*>([\\\\s\\\\S]*?)<\\/a>\", 'ig');\n    var users = Array();\n    var usersLow= Array()\n    var regexLogin= new RegExp(\"@| \u00a6+|<span[^>]*>([^<]+)<\\/span>\", 'ig');\n    while ( (match=regexUsers.exec(document.body.innerHTML)) != null ) {\n        var userLogin= match[1].replace(regexLogin, \"$1\");\n        usersLow.push(userLogin.toLowerCase());\n        users[userLogin.toLowerCase()]=userLogin;\n    };\n    usersLow= arrayUnique(usersLow);\n    $(\"textarea\").bind(\"keydown\", function(e) {\n        if (e.target.adduser>=e.target.selectionEnd || e.target.adduser+30<e.target.selectionStart) e.target.adduser= null;\n    });\n    $(\"textarea\").bind(\"keypress\", function(e){\n            if (e.charCode==64) {\n                e.target.adduser=e.target.selectionStart;\n            }\n            if (e.charCode==32 && e.target.adduser!=null) {\n                short=e.target.value.substring(e.target.adduser+1, e.target.selectionStart).toLowerCase();\n                long= e.target.value.substring(e.target.adduser+1, e.target.selectionEnd);\n                var find= null;\n                nextFindIsResult= false;\n                for (var i in usersLow) {\n                    if (usersLow[i]==long.toLowerCase()) {\n                        nextFindIsResult=true;\n                        continue;\n                    }\n                    if (nextFindIsResult && usersLow[i].indexOf(short)==0) { \n                        find= users[usersLow[i]];\n                        break;\n                    }\n                }\n                if (nextFindIsResult && find==null) {\n                    for (var i in usersLow) {\n                        if (usersLow[i].indexOf(short)==0) {\n                            find= users[usersLow[i]];\n                            break;\n                        }\n                    }\n                }\n                //console.log([find, long, short]);\n                if (find) {\n                    completeSelection(e.target, find, short);\n                    if (find==long) {\n                        e.target.selectionStart=e.target.selectionEnd;\n                        return true;\n                    }\n                    return false;\n                }\n            };\n            if (e.target.adduser!=null && e.target.adduser<e.target.selectionStart) {\n                var short= (e.target.value.substring(e.target.adduser+1, e.target.selectionStart)+String.fromCharCode(e.charCode)).toLowerCase();\n                //console.log(short);\n                var find= null;\n                for (var i in usersLow) {\n                    if (usersLow[i].indexOf(short)==0) {\n                        find= users[usersLow[i]];\n                        break;\n                    }\n                }\n                if (find) {\n                    completeSelection(e.target, find, short);\n                    return false;\n                }\n            }\n        }\n    );\n    console.log(users);\n};\n\n\n</script>", "enabled": true, "css": "", "js": "", "preserveDocWrite": true}